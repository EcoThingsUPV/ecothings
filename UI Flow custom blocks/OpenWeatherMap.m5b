{"category":"OpenWeatherMap","color":"#30ab49","blocks":["__OpenWeatherMap_Initizalize","__OpenWeatherMap_getCurrentWeather","__OpenWeatherMap_getCoordinates","__OpenWeatherMap_getData"],"jscode":"// Block __OpenWeatherMap_Initizalize\nvar __OpenWeatherMap_Initizalize_json = {\n    \"previousStatement\": null,\n    \"nextStatement\": null,\n    \"message0\": \"%1 %2\",\n    \"args0\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"Initialize Open Weather Map\"\n        },\n        {\n            \"type\": \"field_image\",\n            \"src\": \"https://static.thenounproject.com/png/7747-200.png\",\n            \"width\": 50,\n            \"height\": 50,\n            \"alt\": \"*\"\n        }\n    ], \n    \"colour\": \"#30ab49\"\n};\n\nwindow['Blockly'].Blocks['__OpenWeatherMap_Initizalize'] = {\n    init: function() {\n        this.jsonInit(__OpenWeatherMap_Initizalize_json);\n        this.appendDummyInput()\n            .appendField(\"City:\")\n            .appendField(new Blockly.FieldImage(\n                \"https://cdn-icons-png.flaticon.com/512/2451/2451474.png\",\n                20,\n                20,\n                \"*\"))\n            .appendField(new Blockly.FieldTextInput(''),\n            'City');\n\n        this.appendDummyInput()\n            .appendField(\"Country code:\")\n            .appendField(new Blockly.FieldImage(\n                \"https://img.icons8.com/ios/500/country.png\",\n                20,\n                20,\n                \"*\"))\n            .appendField(new Blockly.FieldTextInput(''),\n            'Country_code');\n\n        this.appendDummyInput()\n            .appendField(\"API Key:\")\n            .appendField(new Blockly.FieldImage(\n                \"https://www.freeiconspng.com/thumbs/key-icon/black-key-symbol-icon-6.png\",\n                20,\n                20,\n                \"*\"))\n            .appendField(new Blockly.FieldTextInput(''),\n            'API_Key');\n\n    }\n};\n\nwindow['Blockly'].Python['__OpenWeatherMap_Initizalize'] = function(block) {\n    var City = block.getFieldValue('City');\nvar Country_code = block.getFieldValue('Country_code');\nvar API_Key = block.getFieldValue('API_Key');\n    return `global coordinates\nglobal apikey\napikey = ${API_Key}\n\nlocation = ${City} + \",\" + ${Country_code}\nuri = \"http://api.openweathermap.org/geo/1.0/direct?q=\" + location + \"&appid=\" + ${API_Key}\ntry:\n    req = urequests.request(method='GET', url=uri, headers={})\n    response = json.loads((req.text))\n    lat = response[0]['lat']\n    lon = response[0]['lon']\nexcept:\n    lat = None\n    lon = None\n    pass\ncoordinates = (lat, lon)` + \"\\n\";\n};\n\n// Block __OpenWeatherMap_getCurrentWeather\nvar __OpenWeatherMap_getCurrentWeather_json = {\n    \"previousStatement\": null,\n    \"nextStatement\": null,\n    \"message0\": \"%1 %2\",\n    \"args0\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"Load current weather data\"\n        },\n        {\n            \"type\": \"field_image\",\n            \"src\": \"https://www.iconpacks.net/icons/2/free-arrows-refresh-icon-2847-thumb.png\",\n            \"width\": 25,\n            \"height\": 25,\n            \"alt\": \"*\"\n        }\n    ],\n    \"colour\": \"#30ab49\"\n};\n\nwindow['Blockly'].Blocks['__OpenWeatherMap_getCurrentWeather'] = {\n    init: function() {\n        this.jsonInit(__OpenWeatherMap_getCurrentWeather_json);\n    }\n};\n\nwindow['Blockly'].Python['__OpenWeatherMap_getCurrentWeather'] = function(block) {\n        return `global tmp\nglobal feels_like_tmp\nglobal wther_state\nglobal icon_filename\n\nuri = 'https://api.openweathermap.org/data/2.5/weather?lat=' + str(coordinates[0]) + '&lon=' + str(coordinates[1]) + '&appid=' + apikey\ntry:\n    req = urequests.request(method='GET', url=uri, headers={})\n    response = json.loads((req.text))\n    try:\n        tmp = response['main']['temp'] - 273.15\n    except:\n        pass\n    try:\n        feels_like_tmp = response['main']['feels_like'] - 273.15\n    except:\n        pass\n    try:\n        wther_state = response['weather'][0]['description']\n    except:\n        pass\n    try:\n        icon_filename = response['weather'][0]['icon'].rstrip('d')\n    except:\n        pass\nexcept:\n    pass` + \"\\n\";\n};\n\n// Block __OpenWeatherMap_getCoordinates\nvar __OpenWeatherMap_getCoordinates_json = {\n    \"output\": null,\n    \"message0\": \"%1 %2\",\n    \"args0\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"Get coordinates from OpenWeatherMap\"\n        },\n        {\n            \"type\": \"field_image\",\n            \"src\": \"https://icons.iconarchive.com/icons/icons8/windows-8/512/Maps-Worldwide-Location-icon.png\",\n            \"width\": 20,\n            \"height\": 20,\n            \"alt\": \"*\"\n        }\n    ],\n    \"colour\": \"#30ab49\"\n};\n\nwindow['Blockly'].Blocks['__OpenWeatherMap_getCoordinates'] = {\n    init: function() {\n        this.jsonInit(__OpenWeatherMap_getCoordinates_json);\n    }\n};\n\nwindow['Blockly'].Python['__OpenWeatherMap_getCoordinates'] = function(block) {\n        return [`coordinates`, Blockly.Python.ORDER_CONDITIONAL]\n};\n\n// Block __OpenWeatherMap_getData\nvar __OpenWeatherMap_getData_json = {\n    \"output\": null,\n    \"message0\": \"%1 %2 %3\",\n    \"args0\": [\n        {\n            \"type\": \"field_label\",\n            \"text\": \"Get\"\n        },\n        {\n            \"type\": \"field_dropdown\",\n            \"name\": \"data_selection\",\n            \"options\": [\n                [ \"temperature\", \"int(tmp)\" ],\n                [ \"feels-like temperature\", \"int(feels_like_tmp)\" ],\n                [ \"weather description\", \"wther_state\" ],\n                [ \"weather icon name\", \"icon_filename\" ]\n            ]\n        },\n        {\n            \"type\": \"field_label\",\n            \"text\": \"from OpenWeatherMap\"\n        }\n    ],\n    \"colour\": \"#30ab49\"\n};\n\nwindow['Blockly'].Blocks['__OpenWeatherMap_getData'] = {\n    init: function() {\n        this.jsonInit(__OpenWeatherMap_getData_json);\n    }\n};\n\nwindow['Blockly'].Python['__OpenWeatherMap_getData'] = function(block) {\n        var data_selection = block.getFieldValue('data_selection');\n        return [`${data_selection}`, Blockly.Python.ORDER_CONDITIONAL]\n};\n\n\n","code":{"Initizalize":["window['Blockly'].Python['__OpenWeatherMap_Initizalize'] = function(block) {\n    var City = block.getFieldValue('City');\nvar Country_code = block.getFieldValue('Country_code');\nvar API_Key = block.getFieldValue('API_Key');\n    return `global coordinates\nglobal apikey\napikey = ${API_Key}\n\nlocation = ${City} + \",\" + ${Country_code}\nuri = \"http://api.openweathermap.org/geo/1.0/direct?q=\" + location + \"&appid=\" + ${API_Key}\ntry:\n    req = urequests.request(method='GET', url=uri, headers={})\n    response = json.loads((req.text))\n    lat = response[0]['lat']\n    lon = response[0]['lon']\nexcept:\n    lat = None\n    lon = None\n    pass\ncoordinates = (lat, lon)` + \"\\n\";\n};\n\n","global coordinates\nglobal apikey\napikey = ${API_Key}\n\nlocation = ${City} + \",\" + ${Country_code}\nuri = \"http://api.openweathermap.org/geo/1.0/direct?q=\" + location + \"&appid=\" + ${API_Key}\ntry:\n    req = urequests.request(method='GET', url=uri, headers={})\n    response = json.loads((req.text))\n    lat = response[0]['lat']\n    lon = response[0]['lon']\nexcept:\n    lat = None\n    lon = None\n    pass\ncoordinates = (lat, lon)"],"getCurrentWeather":["window['Blockly'].Python['__OpenWeatherMap_getCurrentWeather'] = function(block) {\n        return `global tmp\nglobal feels_like_tmp\nglobal wther_state\nglobal icon_filename\n\nuri = 'https://api.openweathermap.org/data/2.5/weather?lat=' + str(coordinates[0]) + '&lon=' + str(coordinates[1]) + '&appid=' + apikey\ntry:\n    req = urequests.request(method='GET', url=uri, headers={})\n    response = json.loads((req.text))\n    try:\n        tmp = response['main']['temp'] - 273.15\n    except:\n        pass\n    try:\n        feels_like_tmp = response['main']['feels_like'] - 273.15\n    except:\n        pass\n    try:\n        wther_state = response['weather'][0]['description']\n    except:\n        pass\n    try:\n        icon_filename = response['weather'][0]['icon'].rstrip('d')\n    except:\n        pass\nexcept:\n    pass` + \"\\n\";\n};\n\n","global tmp\nglobal feels_like_tmp\nglobal wther_state\nglobal icon_filename\n\nuri = 'https://api.openweathermap.org/data/2.5/weather?lat=' + str(coordinates[0]) + '&lon=' + str(coordinates[1]) + '&appid=' + apikey\ntry:\n    req = urequests.request(method='GET', url=uri, headers={})\n    response = json.loads((req.text))\n    try:\n        tmp = response['main']['temp'] - 273.15\n    except:\n        pass\n    try:\n        feels_like_tmp = response['main']['feels_like'] - 273.15\n    except:\n        pass\n    try:\n        wther_state = response['weather'][0]['description']\n    except:\n        pass\n    try:\n        icon_filename = response['weather'][0]['icon'].rstrip('d')\n    except:\n        pass\nexcept:\n    pass"],"getCoordinates":["window['Blockly'].Python['__OpenWeatherMap_getCoordinates'] = function(block) {\n        return [`coordinates`, Blockly.Python.ORDER_CONDITIONAL]\n};\n\n","coordinates"],"getData":["window['Blockly'].Python['__OpenWeatherMap_getData'] = function(block) {\n        var data_selection = block.getFieldValue('data_selection');\n        return [`${data_selection}`, Blockly.Python.ORDER_CONDITIONAL]\n};\n\n","${data_selection}"]}}